webpackJsonp([1],{"+4UY":function(t,e){},CKZX:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},n=a("VU/8")({name:"App"},i,!1,null,null,null).exports,o=a("/ocq"),r=a("kxiW"),l=a.n(r),c={data:()=>({user:null,lat:0,lng:0,watchPositionId:null}),mounted(){l.a.auth().onAuthStateChanged(t=>{this.user=t})},methods:{startLocationUpdates(){var t=new google.maps.Map(this.$refs.map,{zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP}),e=new google.maps.Marker({map:t});this.watchPositionId=navigator.geolocation.watchPosition(a=>{this.lat=a.coords.latitude,this.lng=a.coords.longitude,t.setCenter(new google.maps.LatLng(this.lat,this.lng)),e.setPosition(new google.maps.LatLng(this.lat,this.lng)),this.updateLocation(this.lat,this.lng)},t=>{console.log(t.message)})},stopLocationUpdates(){navigator.geolocation.clearWatch(this.watchPositionId)},signOutButtonPressed(){l.a.auth().signOut().then(t=>{this.$router.push({name:"Signin"})}).catch(t=>{console.log(t.message)})},updateLocation(t,e){l.a.firestore().collection("users").doc(this.user.uid).set({lat:t,lng:e,active:!0},{merge:!0})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"driver-view"},[a("section",{staticClass:"top-bar"},[t.user?a("div",[t._v(t._s(t.user.email))]):t._e(),t._v(" "),a("div",[t._v("Driver")]),t._v(" "),a("button",{staticClass:"ui button red",on:{click:t.signOutButtonPressed}},[t._v("Signout")])]),t._v(" "),a("section",{ref:"map",staticClass:"map"}),t._v(" "),a("section",{staticClass:"bottom-bar"},[a("div",{staticClass:"latLngLabel"},[t._v(t._s(t.lat)+", "+t._s(t.lng))]),t._v(" "),a("button",{staticClass:"ui button green",on:{click:t.startLocationUpdates}},[a("i",{staticClass:"circle dot outline icon large"}),t._v("\n      Start Location\n    ")]),t._v(" "),a("button",{staticClass:"ui button red",on:{click:t.stopLocationUpdates}},[a("i",{staticClass:"circle dot outline icon large"}),t._v("\n      Stop Location\n    ")])])])},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(t){a("CKZX")},"data-v-3a8e5bbf",null).exports,p={data:()=>({email:"",password:""}),methods:{loginButtonPressed(){l.a.auth().signInWithEmailAndPassword(this.email,this.password).then(t=>{console.log("user is singed in ")}).catch(t=>{console.log(t.message)})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"ui centered grid",staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"column",staticStyle:{"max-width":"450px"}},[a("form",{staticClass:"ui segment large form"},[a("div",{staticClass:"ui segment"},[a("div",{staticClass:"field"},[a("div",{staticClass:"ui left icon input large"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",placeholder:"Enter your email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),a("i",{staticClass:"ui icon user"})])]),t._v(" "),a("div",{staticClass:"field"},[a("div",{staticClass:"ui left icon input large"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Enter your password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),a("i",{staticClass:"ui icon key"})])]),t._v(" "),a("button",{staticClass:"ui button fluid large red",on:{click:t.loginButtonPressed}},[t._v("Log in")])]),t._v(" "),a("router-link",{staticClass:"ui button basic",attrs:{to:{name:"SignUp"},tag:"a"}},[t._v("Sign up")])],1)])])},staticRenderFns:[]},g=a("VU/8")(p,m,!1,null,null,null).exports,h={data:()=>({email:"",password:""}),mounted(){},methods:{signUpButtonPressed(){l.a.auth().createUserWithEmailAndPassword(this.email,this.password).then(t=>{this.addUserToDB(t)}).catch(t=>{this.error=t.message})},async addUserToDB({user:t}){try{const e=l.a.firestore();_=await e.collection("users").doc(t.uid).set({email:t.email,active:!1}),this.$router.push({name:"Driver"})}catch(t){console.log(t.message)}}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"ui centered grid",staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"column",staticStyle:{"max-width":"450px"}},[a("form",{staticClass:"ui segment large form"},[a("div",{staticClass:"ui segment"},[a("div",{staticClass:"field"},[a("div",{staticClass:"ui left icon input large"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",placeholder:"Enter your email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),a("i",{staticClass:"ui icon user"})])]),t._v(" "),a("div",{staticClass:"field"},[a("div",{staticClass:"ui left icon input large"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Enter your password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),a("i",{staticClass:"ui icon key"})])]),t._v(" "),a("button",{staticClass:"ui button fluid large green",on:{click:t.signUpButtonPressed}},[t._v("Sign up")])])]),t._v(" "),a("router-link",{staticClass:"ui button basic",attrs:{to:{name:"Signin"},tag:"a"}},[t._v("Log in")])],1)])},staticRenderFns:[]},f=a("VU/8")(h,v,!1,null,null,null).exports,w={data:()=>({user:null,drivers:[],map:null}),async mounted(){l.a.auth().onAuthStateChanged(t=>{this.user=t}),this.map=new google.maps.Map(this.$refs.map,{zoom:10,center:new google.maps.LatLng(37.33446146,-122.04380955),mapTypeId:google.maps.MapTypeId.ROADMAP});const{docs:t}=await l.a.firestore().collection("users").where("active","==",!0).get(),e=[],a=[];for(let s=0;s<t.length;s++)e.push(new google.maps.Marker({map:this.map})),a.push(new google.maps.InfoWindow({disableAutoPan:!0}));l.a.firestore().collection("users").where("active","==",!0).onSnapshot(t=>{this.drivers=[];for(let i=0;i<t.docs.length;i++){var s=t.docs[i].data();this.drivers.push(s),e[i].setPosition(new google.maps.LatLng(s.lat,s.lng)),a[i].setContent(`<div class="ui header">${s.email} </div>`),a[i].open(this.map,e[i])}})},methods:{signOutButtonPressed(){l.a.auth().signOut().then(t=>{this.$router.push({name:"Signin"})}).catch(t=>{console.log(t.message)})}}},C={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"admin-view"},[e("h1",[this._v("Admin View")])])}]};var b=a("VU/8")(w,C,!1,function(t){a("+4UY")},"data-v-96b9e7ec",null).exports;s.a.use(o.a);let P=new o.a({routes:[{path:"/driver",name:"Driver",component:d,meta:{requiresAuth:!0}},{path:"/signin",name:"Signin",component:g,meta:{guest:!0}},{path:"/signup",name:"SignUp",component:f,meta:{guest:!0}},{path:"/admin",name:"Admin",component:b,meta:{requiresAuth:!0}}]});P.beforeEach((t,e,a)=>{l.a.auth().onAuthStateChanged(s=>{!s&&t.matched.some(t=>t.meta.requiresAuth)?a({name:"Signin"}):s?t.matched.some(t=>t.meta.guest)?a(e.fullPath):l.a.firestore().collection("roles").doc(s.uid).get().then(t=>{t.data().isAdmin?a({name:"Admin"}):a({name:"Driver"})}):a()}),a()});var y=P,A=a("yviF");s.a.config.productionTip=!1;A.initializeApp({apiKey:"AIzaSyAlWGthbLwT8-zmmAc3PakcQGWg2PxWB-Q",authDomain:"map-locator-95bd3.firebaseapp.com",projectId:"map-locator-95bd3",storageBucket:"map-locator-95bd3.appspot.com",messagingSenderId:"430940186939",appId:"1:430940186939:web:1c8b97ed8a0ee01f7aef1e",measurementId:"G-5TR441JF54"}),new s.a({el:"#app",router:y,components:{App:n},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.316f78e8eb3d164cc20d.js.map